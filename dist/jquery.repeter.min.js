!function(e){e.fn.repeter=function(t){var n=this,r={"class":"element",mirrorIn:null,insertIn:null},l=e.extend({addBtnClass:".add",remBtnClass:".remove",tplClass:".template",formSelector:"form",elements:r},t),a=l.elements["class"]||r["class"];n.on("click",l.addBtnClass,function(){var t=e(this).closest("."+n.attr("class").split(" ").join("."));s(t)}).on("click","."+a+" "+l.remBtnClass,function(){o(this)});var s=function(t){var n=e(t).find(l.tplClass)[0],r=e(t).find("."+a).length,s="SCRIPT"==n.nodeName?e(n).tmpl({numElement:r}):e(n).clone().removeClass(l.tplClass);s.addClass(a+" r-ele-"+r).data("r-ele",r);var o=l.elements.insertIn||l.elements.mirrorIn;if(o){if(l.elements.mirrorIn){var i=s.clone().removeClass(a);i.find(".remove")[0].remove()}e(o).append(i||s)}if(l.elements.insertIn&&!l.elements.mirrorIn||s.insertBefore(n),e.fn.formValidation||e.fn.validator){var d=e(t).closest(l.formSelector);s.find("[disabled]").prop("disabled",!1),e.fn.validator&&d.data("bs.validator")&&d.validator("reloadFields"),e.fn.formValidation&&d.data("formValidation")&&s.find("input,textarea,select").filter(":visible").each(function(){d.formValidation("addField",this.name)})}return{parent:t,addedElement:s,removedElement:null}},o=function(t){var r=e(t).closest("."+n.attr("class").split(" ").join("."));t="number"==typeof t?e("button.remove","r-ele-"+t):e(t,r),t.closest(".element").fadeOut(250,function(){var n=e(this).data("r-ele"),s=e("."+a,r).length;(e.fn.formValidation||e.fn.validator)&&t.prev().find("select,input,textarea,button").last().focus(),l.elements.mirrorIn&&e(".r-ele-"+n,l.elements.mirrorIn).remove(),e(this).remove();for(var o=n+1;s>=o;o++)e(".r-ele-"+o,r).data("r-ele",o-1).removeClass("r-ele-"+o).addClass("r-ele-"+(o-1));return{parent:r,addedElement:null,removedElement:t}})};return n}}(jQuery);
