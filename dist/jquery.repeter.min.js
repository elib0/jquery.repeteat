!function(e,t,l,n){"use strict";function s(t,l){this.element=t,this.template=null,this.items=[],this.opt=e.extend(!0,{},a,l),this._name=r,this.init()}function o(t,l){var n=e(t).data("r-ele"),s=e("."+l.opt.elements["class"],l.element).length;(e.fn.formValidation||e.fn.validator)&&t.prev().find("select,input,textarea,button").last().focus(),e(t).remove(),l.opt.elements.mirror.selector&&e(".r-ele-"+n,l.opt.elements.mirror.selector).remove(),l.items.splice(n,1);for(var o=n+1;s>o;o++){var r=e.tmplItem(e(".r-ele-"+o,l.element));r.data.numElement=o-1,r.update(),e(r.nodes).data("r-ele",r.data.numElement).addClass(l.opt.elements["class"]+" r-ele-"+r.data.numElement),l.opt.elements.mirror.selector&&e(".r-ele-"+o,l.opt.elements.mirror.selector).removeClass("r-ele-"+o).addClass("r-ele-"+r.data.numElement)}}var r="repeter",a={addBtnSelector:".add",remBtnSelector:".remove",tplSelector:".template",formSelector:"form",elements:{"class":"element",insertIn:null,removeClasses:null,mirror:{selector:null,tplSelector:null}}};e.extend(s.prototype,{init:function(){var t=this;return this.template=e(this.element).find(this.opt.tplSelector)[0],this._template=e(this.element).find(this.opt.elements.mirror.tplSelector)[0],e(t.element).on("click",t.opt.addBtnSelector,function(){t.addItem()}).on("click","."+t.opt.elements["class"]+" "+t.opt.remBtnSelector,function(){t.removeItem(this)}),this},addItem:function(){var t=this,l=this.template,n=this._template,s=e(this.element).find("."+this.opt.elements["class"]).length,o="SCRIPT"==l.nodeName?e(l).tmpl({numElement:s}):e(l).clone().removeClass(t.opt.tplSelector);o.addClass(t.opt.elements["class"]+" r-ele-"+s).data("r-ele",s);var r=t.opt.elements.insertIn||t.opt.elements.mirror.selector;if(r){var a=null;if(t.opt.elements.mirror.selector)if(n){var m="SCRIPT"==n.nodeName?e(n).tmpl({numElement:s}):e(n).clone().removeClass(t.opt.tplSelector);m.addClass(t.opt.elements["class"]+" r-ele-"+s).data("r-ele",s),a=m.removeClass(t.opt.elements["class"])}else a=o.clone().removeClass(t.opt.elements["class"]),a.find(".remove")[0].remove();e(r).append(a||o),t.items.push(e.tmplItem(a||o))}if(t.opt.elements.insertIn&&!t.opt.elements.mirror.selector||o.insertBefore(l),e.fn.formValidation||e.fn.validator){var i=e(t.element).closest(t.opt.formSelector);o.find("[disabled]").prop("disabled",!1),e.fn.validator&&i.data("bs.validator")&&i.validator("reloadFields"),e.fn.formValidation&&i.data("formValidation")&&o.find("input,textarea,select").filter(":visible").each(function(){i.formValidation("addField",this.name)})}return{parent:t.element,addedElement:o,removedElement:null}},removeItem:function(t){var l=this,t="number"==typeof t?e("r-ele-"+t,l.element):t,n=e(t).closest("."+l.opt.elements["class"]);if(l.opt.elements.removeClasses){var s="webkitAnimationEnd oanimationend msAnimationEnd animationend";n.addClass(l.opt.elements.removeClasses).one(s,function(e){return o(n,l),n.removeClass(l.opt.elements.removeClasses),{parent:l,addedElement:null,removedElement:t}})}else o(n,l)}}),e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new s(this,t))})}}(jQuery,window,document);