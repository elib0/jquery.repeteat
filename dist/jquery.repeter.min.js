!function(e){e.fn.repeter=function(n){var l=this,r={"class":"element",mirrorIn:null,mirrorTpl:null,insertIn:null},t=e.extend({addBtnClass:".add",remBtnClass:".remove",tplClass:".template",formSelector:"form",elements:r},n),a=t.elements["class"]||r["class"];l.on("click",t.addBtnClass,function(){var n=e(this).closest("."+l.attr("class").split(" ").join("."));s(n)}).on("click","."+a+" "+t.remBtnClass,function(){o(this)});var s=function(n){var l=e(n).find(t.tplClass)[0],r=e(n).find("."+a).length,s=e(n).find(t.elements.mirrorTpl)[0];$new="SCRIPT"==l.nodeName?e(l).tmpl({numElement:r}):e(l).clone().removeClass(t.tplClass),$new.addClass(a+" r-ele-"+r).data("r-ele",r);var o=null,i=t.elements.insertIn||t.elements.mirrorIn;if(i){if(t.elements.mirrorIn)if(s){var m="SCRIPT"==s.nodeName?e(s).tmpl({numElement:r}):e(s).clone().removeClass(t.tplClass);m.addClass(a+" r-ele-"+r).data("r-ele",r),o=m.clone().removeClass(a)}else o=$new.clone().removeClass(a),o.find(".remove")[0].remove();e(i).append(o||$new)}if(t.elements.insertIn&&!t.elements.mirrorIn||$new.insertBefore(l),e.fn.formValidation||e.fn.validator){var d=e(n).closest(t.formSelector);$new.find("[disabled]").prop("disabled",!1),e.fn.validator&&d.data("bs.validator")&&d.validator("reloadFields"),e.fn.formValidation&&d.data("formValidation")&&$new.find("input,textarea,select").filter(":visible").each(function(){d.formValidation("addField",this.name)})}return{parent:n,addedElement:$new,removedElement:null}},o=function(n){var r=e(n).closest("."+l.attr("class").split(" ").join("."));n="number"==typeof n?e("button.remove","r-ele-"+n):e(n,r),n.closest(".element").fadeOut(250,function(){var l=e(this).data("r-ele"),s=e("."+a,r).length;(e.fn.formValidation||e.fn.validator)&&n.prev().find("select,input,textarea,button").last().focus(),t.elements.mirrorIn&&e(".r-ele-"+l,t.elements.mirrorIn).remove(),e(this).remove();for(var o=l+1;s>=o;o++)e(".r-ele-"+o,r).data("r-ele",o-1).removeClass("r-ele-"+o).addClass("r-ele-"+(o-1));return{parent:r,addedElement:null,removedElement:n}})};return l}}(jQuery);