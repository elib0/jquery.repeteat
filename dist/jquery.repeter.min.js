!function(e){e.fn.repeter=function(t){var l=this,r={addBtnSelector:".add",remBtnSelector:".remove",tplSelector:".template",formSelector:"form",elements:{"class":"element",insertIn:null,mirror:{selector:null,tplSelector:null}}},n=e.extend(!0,{},r,t),o=n.elements["class"]||r.elements["class"];l.on("click",n.addBtnSelector,function(){var t=e(this).closest("."+l.attr("class").split(" ").join("."));a(t)}).on("click","."+o+" "+n.remBtnSelector,function(){s(this)});var a=function(t){var l=e(t).find(n.tplSelector)[0],r=e(t).find("."+o).length,a=e(t).find(n.elements.mirror.tplSelector)[0];$new="SCRIPT"==l.nodeName?e(l).tmpl({numElement:r}):e(l).clone().removeClass(n.tplSelector),$new.addClass(o+" r-ele-"+r).data("r-ele",r);var s=n.elements.insertIn||n.elements.mirror.selector;if(s){var i=null;if(n.elements.mirror.selector)if(a){var m="SCRIPT"==a.nodeName?e(a).tmpl({numElement:r}):e(a).clone().removeClass(n.tplSelector);m.addClass(o+" r-ele-"+r).data("r-ele",r),i=m.removeClass(o)}else i=$new.clone().removeClass(o),i.find(".remove")[0].remove();e(s).append(i||$new)}if(n.elements.insertIn&&!n.elements.mirror.selector||$new.insertBefore(l),e.fn.formValidation||e.fn.validator){var d=e(t).closest(n.formSelector);$new.find("[disabled]").prop("disabled",!1),e.fn.validator&&d.data("bs.validator")&&d.validator("reloadFields"),e.fn.formValidation&&d.data("formValidation")&&$new.find("input,textarea,select").filter(":visible").each(function(){d.formValidation("addField",this.name)})}return{parent:t,addedElement:$new,removedElement:null}},s=function(t){var r=e(t).closest("."+l.attr("class").split(" ").join("."));t="number"==typeof t?e("button.remove","r-ele-"+t):e(t,r),t.closest(".element").fadeOut(250,function(){var l=e(this).data("r-ele"),a=e("."+o,r).length;(e.fn.formValidation||e.fn.validator)&&t.prev().find("select,input,textarea,button").last().focus(),n.elements.mirror.selector&&e(".r-ele-"+l,n.elements.mirror.selector).remove(),e(this).remove();for(var s=l+1;a>=s;s++)e(".r-ele-"+s,r).data("r-ele",s-1).removeClass("r-ele-"+s).addClass("r-ele-"+(s-1));return{parent:r,addedElement:null,removedElement:t}})};return l}}(jQuery);

